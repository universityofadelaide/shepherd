langcode: en
status: true
id: shp_site
label: Site node
migration_group: shp_content_migration
migration_tags:
  - shp_content_migration

source:
  key: migrate
  plugin: d8_entity
  entity_type: node
  bundle: shp_site
  track_changes: yes

process:
  uid:
    plugin: default_value
    default_value: 1
  changed: changed
  created: created
  status: status
  type: type
  title: title
  field_shp_site: field_shp_site
  field_shp_go_live: field_shp_go_live
  field_shp_path: field_shp_path
  field_shp_domain: field_shp_domain
  field_shp_project:
    plugin: migration_lookup
    migration: shp_project
    source: field_shp_project/0/target_id

  field_shp_short_name: field_shp_short_name
  field_shp_storage_size: field_shp_storage_size
  # Only support up to five tags for now.
  field_tags/0/target_id:
    plugin: migration_lookup
    migration: taxonomy_terms
    source: field_tags/0/target_id
  field_tags/1/target_id:
    plugin: migration_lookup
    migration: taxonomy_terms
    source: field_tags/1/target_id
  field_tags/2/target_id:
    plugin: migration_lookup
    migration: taxonomy_terms
    source: field_tags/2/target_id
  field_tags/3/target_id:
    plugin: migration_lookup
    migration: taxonomy_terms
    source: field_tags/3/target_id
  field_tags/4/target_id:
    plugin: migration_lookup
    migration: taxonomy_terms
    source: field_tags/4/target_id

  moderation_state:
    plugin: default_value
    default_value: 'published'

destination:
  plugin: entity:node
  default_bundle: shp_site

migration_dependencies:
  required:
    - taxonomy_terms
  optional: [ ]
